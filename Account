create or replace view FINANCE.ADMIN_CORE_CURATED.CTS_NS_ACCOUNT(
	NS_ACCOUNT_ID,
	NS_PARENT_ACCOUNT_ID,
	GPS_NS_ACCOUNT_ID,
	ACCOUNT_NUMBER,
	ACCOUNT_NAME,
	ACCOUNT_FULL_NAME,
	PARENT_ACCOUNT_NAME,
	ACCOUNT_TYPE,
	SPECIAL_ACCOUNT,
	CASHFLOWRATE,
	GENERALRATE,
	IS_LEFT_SIDE,
	IS_BALANCE_SHEET,
	IS_INACTIVE
) as
--
-- D3 5.12.24 ADDED GPS_NS_ACCOUNT_ID
--
SELECT
    SD.ID AS NS_ACCOUNT_ID,
    SD.PARENT AS NS_PARENT_ACCOUNT_ID,
    SD.CUSTRECORD_GPS_NS_ACCOUNT_ID AS GPS_NS_ACCOUNT_ID,
    SD.ACCTNUMBER AS ACCOUNT_NUMBER,
    SD.ACCOUNTSEARCHDISPLAYNAMECOPY AS ACCOUNT_NAME,
    SD.FULLNAME AS ACCOUNT_FULL_NAME,
    PAC.ACCOUNTSEARCHDISPLAYNAMECOPY PARENT_ACCOUNT_NAME,
    ACT.LONGNAME AS ACCOUNT_TYPE,
    SD.SSPECACCT AS SPECIAL_ACCOUNT,
    SD.CASHFLOWRATE,
    SD.GENERALRATE,
    CASE ACT.LEFT WHEN 'T' THEN 'Yes' ELSE 'No' END AS IS_LEFT_SIDE,
    CASE ACT.BALANCESHEET WHEN 'T' THEN 'Yes' ELSE 'No' END AS IS_BALANCE_SHEET,
    CASE SD.ISINACTIVE WHEN 'F' THEN 'No' ELSE 'Yes' END AS IS_INACTIVE
        
FROM
    FINANCE.CTS_NETSUITE2.ACCOUNT SD
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.ACCOUNTTYPE ACT
            ON SD.ACCTTYPE = ACT.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.ACCOUNT PAC
            ON SD.PARENT = PAC.ID
 
WHERE
    SD._FIVETRAN_DELETED = 'FALSE';
