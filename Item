create or replace view FINANCE.ADMIN_CORE_CURATED.CTS_NS_ITEM(
	NS_ITEM_ID,
	EXTERNALID,
	FULLNAME,
	DESCRIPTION,
	ITEMID,
	PRODUCT_CATEGORY,
	PRODUCT_CATEGORY2,
	PRODUCT_APPLICATION,
	PRODUCT_APPLICATION2,
	ITEM_TYPE,
	SUBTYPE,
	MANUFACTURER,
	MPN,
	IS_FULFILLABLE,
	IS_INACTIVE,
	IS_SERIAL_ITEM,
	INCLUDECHILDREN,
	CLASS,
	PARENT,
	INCOME_ACCOUNT,
	ASSET_ACCOUNT,
	EXPENSE_ACCOUNT,
	AVERAGE_COST,
	COST
) as 
--
--
--
SELECT 
    SD.ID AS NS_ITEM_ID, 
    SD.EXTERNALID,
    SD.FULLNAME,
    SD.DESCRIPTION, 
    SD.ITEMID,
    PC.NAME AS PRODUCT_CATEGORY,
    CAT.NAME AS PRODUCT_CATEGORY2,
    AP.NAME AS PRODUCT_APPLICATION,
    AP2.NAME AS PRODUCT_APPLICATION2,
    IT.NAME AS ITEM_TYPE,
    SD.SUBTYPE, 
    SD.MANUFACTURER,
    SD.MPN,
    CASE 
        WHEN SD.ISFULFILLABLE = 'T' THEN 'Yes'
        WHEN SD.ISFULFILLABLE = 'F' THEN 'No'
        else null 
    END AS IS_FULFILLABLE, 
    CASE
        WHEN SD.ISINACTIVE = 'T' THEN 'Yes'
        WHEN SD.ISINACTIVE = 'F' THEN 'No'
        else null 
    END AS IS_INACTIVE, 
    CASE 
        WHEN SD.ISSERIALITEM = 'T' THEN 'Yes'
        WHEN SD.ISSERIALITEM = 'F' THEN 'No'
        else null 
    END AS IS_SERIAL_ITEM,
    CASE
        WHEN SD.INCLUDECHILDREN = 'T' THEN 'Yes'
        ELSE 'No'
    END AS INCLUDECHILDREN,
    CL.NAME AS CLASS,
    SD.PARENT, 
    IAC.ACCOUNTSEARCHDISPLAYNAME AS INCOME_ACCOUNT,
    AAC.ACCOUNTSEARCHDISPLAYNAME AS ASSET_ACCOUNT,
    EAC.ACCOUNTSEARCHDISPLAYNAME AS EXPENSE_ACCOUNT,
    SD.AVERAGECOST AS AVERAGE_COST, 
    SD.COST

FROM 
    FINANCE.CTS_NETSUITE2.ITEM SD       
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.ITEMTYPE AS IT      
            ON SD.ITEMTYPE = IT.ID
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.CLASSIFICATION CL   
            ON SD.CLASS = CL.ID 
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.CUSTOMRECORD_CSEG_PRODUCTCATEGOR PC     
            ON SD.CSEG_PRODUCTCATEGOR = PC.ID 
        LEFT JOIN 
    FINANCE.FINANCE.CTS_CSEG_CATEGORIES CAT   
            ON SD.CSEG_PRODUCTCATEGOR = CAT.INTERNAL_ID
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.CUSTOMRECORD_CSEG_APPLICATION AP        
            ON SD.CSEG_APPLICATION = AP.ID
        LEFT JOIN 
    FINANCE.FINANCE.CTS_CSEG_APPLICATION AP2  
            ON SD.CSEG_APPLICATION = AP2.INTERNAL_ID 
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.ACCOUNT IAC         
            ON SD.INCOMEACCOUNT = IAC.ID 
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.ACCOUNT AAC         
            ON SD.ASSETACCOUNT = AAC.ID 
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.ACCOUNT DAC         
            ON SD.DEFERRALACCOUNT = DAC.ID 
        LEFT JOIN 
    FINANCE.CTS_NETSUITE2.ACCOUNT EAC         
            ON SD.EXPENSEACCOUNT = EAC.ID 
WHERE
    SD._FIVETRAN_DELETED = 'FALSE'
            ;
