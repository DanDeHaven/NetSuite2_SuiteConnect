create or replace view FINANCE.ADMIN_CORE_CURATED.CTS_NS_VENDOR(
	NS_VENDOR_ID,
	NS_DEPARTMENT_ID,
	NS_EXPENSE_ACCCOUNT_ID,
	ENTITYID,
	VENDOR_NAME,
	LEGAL_NAME,
	COMPANY_NAME,
	AP_APPROVER,
	VENDOR_CATEGORY,
	TERMS,
	CURRENCY,
	PAYABLES_ACCOUNT,
	EXPENSE_ACCOUNT,
	DEFUALT_GPS_EXPENSE_ACCOUNT_NUMBER_NAME,
	DEFAULT_DEPARTMENT,
	COMMENTS,
	IS_INACTIVE,
	DATE_CREATED,
	BALANCE
) as

SELECT
    SD.ID AS NS_VENDOR_ID,
    SD.CUSTENTITYDEFAULTEXPENSEDEPT AS NS_DEPARTMENT_ID,
    SD.EXPENSEACCOUNT AS NS_EXPENSE_ACCCOUNT_ID,
    SD.ENTITYID,
    SD.ENTITYTITLE AS VENDOR_NAME,
    SD.LEGALNAME AS LEGAL_NAME,
    SD.COMPANYNAME AS COMPANY_NAME,
    APR.FIRSTNAME || ' ' || APR.LASTNAME AS AP_APPROVER,
    VCAT.NAME AS VENDOR_CATEGORY,
    TER.NAME AS TERMS,
    CU.NAME AS CURRENCY,
    PYAC.FULLNAME AS PAYABLES_ACCOUNT,
    EXAC.FULLNAME AS EXPENSE_ACCOUNT,
    GAC."Account Number Name" AS DEFUALT_GPS_EXPENSE_ACCOUNT_NUMBER_NAME, 
    DEP.NAME AS DEFAULT_DEPARTMENT,
    SD.COMMENTS,
    CASE SD.ISINACTIVE WHEN 'F' THEN 'No' ELSE 'Yes' END AS IS_INACTIVE,
    SD.DATECREATED::DATE AS DATE_CREATED,
    SD.BALANCE
    
FROM
    FINANCE.CTS_NETSUITE2.VENDOR SD
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.CURRENCY CU
            ON SD.CURRENCY = CU.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.ACCOUNT EXAC
            ON SD.EXPENSEACCOUNT = EXAC.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.ACCOUNT PYAC
            ON SD.PAYABLESACCOUNT = PYAC.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.EMPLOYEE APR
            ON SD.CUSTENTITY_CTS_VEND_AP_APPROVER = APR.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.TERM TER
            ON SD.TERMS = TER.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.VENDORCATEGORY VCAT
            ON SD.CATEGORY = VCAT.ID
        LEFT OUTER JOIN
    FINANCE.CTS_NETSUITE2.DEPARTMENT DEP
            ON SD.CUSTENTITYDEFAULTEXPENSEDEPT = DEP.ID
        LEFT OUTER JOIN
    FINANCE.ADMIN_APPROVED_MODELS.GPS_NS_DIM_ACCOUNT GAC
            ON EXAC.CUSTRECORD_GPS_NS_ACCOUNT_ID = GAC.NS_ACCOUNT_ID
WHERE
    SD._FIVETRAN_DELETED = 'FALSE'
 
    ;
