create or replace view FINANCE.ADMIN_CORE_CURATED.CTS_NS_ENTITY(
	NS_ENTITY_ID,
	NS_PARENT_ENTITY_ID,
	NS_ENTITY_TOP_LEVEL_PARENT_ID,
	ENTITY_NUMBER,
	ENTITY_ALT_NAME,
	ENTITY_TITLE,
	ENTITY_ID,
	EMAIL,
	IS_INACTIVE,
	IS_PERSON,
	ENTITY_TYPE,
	DATE_CREATED,
	LAST_MODIFIED_DATETIME
) as
--
--  D3 5.28.24 CREATED
--
SELECT
    SD.ID AS NS_ENTITY_ID,
    SD.PARENT AS NS_PARENT_ENTITY_ID,
    SD.TOPLEVELPARENT AS NS_ENTITY_TOP_LEVEL_PARENT_ID,
    SD.ENTITYNUMBER AS ENTITY_NUMBER,
    SD.ALTNAME AS ENTITY_ALT_NAME,
    SD.ENTITYTITLE AS ENTITY_TITLE,
    SD.ENTITYID AS ENTITY_ID,
    SD.EMAIL,
    CASE
        WHEN SD.ISINACTIVE = 'T' THEN 'Yes'
        ELSE 'No'
    END AS IS_INACTIVE,
    CASE
        WHEN SD.ISPERSON = 'T' THEN 'Yes'
        ELSE 'No'
    END AS IS_PERSON,
    SD.TYPE AS ENTITY_TYPE,
    SD.DATECREATED::DATE AS DATE_CREATED,
    SD.LASTMODIFIEDDATE AS LAST_MODIFIED_DATETIME
FROM
    FINANCE.CTS_NETSUITE2.ENTITY SD
WHERE
    SD._FIVETRAN_DELETED = 'FALSE'
    -- AND SD.TYPE IN('Vendor','CustJob')
;
